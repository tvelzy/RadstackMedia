<!DOCTYPE HTML>
<html>
<head>
   <title>Macros</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta name="description" content="Macros" />
   <meta name="copyright" content="© 2012 Kentico Software" /> 
   <meta http-equiv="Cache-control" content="no-cache" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   
   
   <link type="text/css" href="custom.css" rel="stylesheet" /> 
   
   
   
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   
   <script type="text/javascript" src="jquery-1.7.1.min.js"></script>
   <script type="text/javascript" src="jquery.scrollTo-min.js"></script>
   
   
   <script type="text/javascript" src="nsh.js"></script>
   
   
   
   
   <script type="text/javascript" src="ZeroClipboard.js"></script>
   <script type="text/javascript">
var permalinkData = ["index.html",true,"http://devnet.kentico.com/docs/7_0/contexthelp/index.html?macros_tab.htm","Macros","Sorry, your browser can't bookmark pages using this function. Copy the permalink, then press Ctrl+D to bookmark the topic with the permalink.","This page is stored locally. You can only bookmark pages on a web server!"];

var togTocButton = "";
$(document).ready(function() {
  chromeBugCheck("workaround",false);
   
   });
</script>





<!-- Adjustment for IE -->
<!--[if lte IE 8]>
<style type="text/css">
.topichead { padding-right: 0; }
#autoTocWrapper ul li { padding: 3px 3px 4px 3px;}
</style>
<![endif]-->
<!--[if lte IE 7]>
<style type="text/css">
#innerdiv {height: 100%;}
</style>
<![endif]-->
   



         
   <!-- CSS set with project variables and local attributes --> 
   <style type="text/css" media="screen"> 
   body { background: #fff; } 
   #breadcrumbs {width: 100%; background-color: white; border-bottom: 1px solid #000; padding: 0px 0px 5px 15px;
   margin: 3px 0; font-size: 8pt; color: #000;}
   #breadcrumbs a { color: #000; text-decoration: none;}
   #breadcrumbs a:visited { color: #000; }
   #breadcrumbs a:hover { color: #098ae2; text-decoration: none; }
   .help-url { font-size: 10pt; font-family: Arial, Verdana, Helvetica, sans-serif; 
               color: #1f84e8; text-align: center; margin: 5px 20px 10px 0px; 
               padding-top: 14px; border-top: 1px solid #000;}
   .help-url a { color: #098ae2; text-decoration: none; }
   .help-url a:visited { color: #098ae2; }
   .help-url a:hover { color: #098ae2; text-decoration: underline; }
   .highlight {background: #ffff40;}
   .breadhead {padding: 5px 0px 0px 0px !important;}   
   
   #idcontent {overflow:auto !important;}
    
   #innerdiv   
   {   
   padding-left: 5px;
   }
   

   

   </style> 

<!-- Adjustment for IE -->
<!--[if lte IE 8]>
<style type="text/css">
.topichead { padding-right: 0; }
   
</style>
<![endif]-->
 <script type="text/javascript">
// Initialize the page 
addEvent(window, "load", nsrInit);
addEvent(window, "load", doResize);
addEvent(window, "resize", doResize);
addEvent(window, "load", toggleJump);

</script>

<script type="text/javascript">
function mailFB_custom() {
var headerText = unQuot("Feedback on: Kentico CMS 7.0 Context Help - Macros".replace('&nbsp;',''));
var fb1 = "mailto:" + escape('Kentico Support Team <support@kentico.com>') + "?subject=" + headerText;
var titlePath = unQuot("CMS Site Manager &gt; Administration &gt; System &gt; Macros /");
var fb2 = "&body=Ref:%20" + titlePath + "%20ID:%20macros_tab%0A%0D%0A%0D" + unQuot("Dear Support Staff,") + "%0A%0D%0A%0D";
var fb = fb1 + fb2;
document.location.href=fb;
}
</script>

        
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "macros_tab.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head> 

<body>
<!--ZOOMSTOP-->

<div id="printheader">
<span id="printtitle">Kentico CMS 7.0 Context Help</span><br />
<h1 class="p_Heading1"><span class="f_Heading1">Macros</span></h1>
</div>
<div id="idheader" style="border-bottom:1px solid #000;margin:0px 0px;"> 
<table id="breadtable" border="0" cellspacing="0" cellpadding="0" width="100%"> 
  <tr >
  <td align="left" class="breadhead" >
       <p id="breadcrumbs"><a href="mode_selection.htm"
        onmouseover="document.images.main.src='home_h.gif'" 
        onmouseout="document.images.main.src='home.gif'">
        <img name="main" src="home.gif" border="0" alt="Home topic" title="Home topic" /></a> 
        
        CMS Site Manager &gt; Administration &gt; System:</p> 
  </td>
  </tr>
</table>
<table width="99%" border="0" cellspacing="0" cellpadding="0" id="headtable"> 

<!-- Script version of NavHeader -->
  <tr id="scriptNavHead" valign="middle" style="height: auto;"> 
    <td align="left" class="topichead" style="padding-left: 15px;"> 
    <h1 class="p_Heading1"><span class="f_Heading1">Macros</span></h1>

    </td>
    <td align="center" width="20" class="idnav" valign="bottom">
     <a href="dbjoin_stepread.htm"
        onmouseover="document.images.prev.src='button_prev_h.gif'" 
        onmouseout="document.images.prev.src='button_prev.gif'">
        <img name="prev" src="button_prev.gif" border="0" alt="Previous topic" title="Previous topic" /></a>
     
   </td>
   
   <td align="center" width="20" class="idnav" valign="bottom">
     <a href="uipersonalization_dialogs.htm"
        onmouseover="document.images.next.src='button_next_h.gif'" 
        onmouseout="document.images.next.src='button_next.gif'"><img name="next" src="button_next.gif" border="0" alt="Next topic" title="Next topic" /></a>
        
   </td>

   
   
   
   
   

     
   <td id="print-button" align="center" width="20" class="idnav" valign="bottom">
     <a href="javascript: print();" 
     onmouseover="document.images.printbutton.src='print_h.gif'" 
     onmouseout="document.images.printbutton.src='print.gif'"><img name="printbutton" border="0" alt="Print this topic" title="Print this topic" src="print.gif" /></a>
   </td>  
     
     

  
   <td id="mail-feedback" align="center" width="20" class="idnav" valign="bottom">
   <a href="#"
        onclick='mailFB_custom();'
        onmouseover="document.images.feedback.src='mail_h.gif'" 
        onmouseout="document.images.feedback.src='mail.gif'"><img name="feedback" src="mail.gif" border="0" alt="Mail us feedback on this topic!" title="Mail us feedback on this topic!" /></a>
   </td>
   
   <td width="4">&nbsp;</td>
  </tr>
<!-- End script navheader version -->

<!-- NoScript version of navheader -->

  <tr id="noScriptNavHead" valign="middle" style="height: auto;"> 
    <td align="left" class="topichead"> 
    <h1 class="p_Heading1"><span class="f_Heading1">Macros</span></h1>

    </td>
    <td align="center" width="20" class="idnav" valign="bottom">
     <a href="dbjoin_stepread.htm">
        <img src="button_prev.gif" border="0" alt="Previous topic" title="Previous topic" /></a>
     
   </td>
   
   <td align="center" width="20" class="idnav" valign="bottom">
     <a href="uipersonalization_dialogs.htm">
        <img src="button_next.gif" border="0" alt="Next topic" title="Next topic" /></a>
        
   </td>
   
   
   
  
   

     
     
   <td align="center" width="20" class="idnav" valign="bottom">
   <img border="0" alt="JavaScript is required for the print function" title="JavaScript is required for the print function" src="print_d.gif" />
   </td>
     
     
   
   <td align="center" width="20" class="idnav" valign="bottom">
   <a href="mailto:Kentico%20Support%20Team%20<support@kentico.com>?subject=Documentation%20feedback&body=Ref%20ID:%20macros_tab%0D%0D"><img src="mail.gif" border="0" alt="Mail us feedback on this topic!" title="Mail us feedback on this topic!" /></a>
   </td>
   
   <td width="4">&nbsp;</td>
  </tr>

<!-- End noscript navheader version -->
  </table>

<div id="autoTocWrapper"></div></div> 
<div id="permalink" class="popups">
<table cellspacing="3" cellpadding="0" width="100%">
   <tr>
   <td align="left">
   <div id="permalink_box" style="position:relative">
   <input type="button" id="selectPermalink" value="Copy Permalink" />
   </div>
   </td>
   <td align="center">
   <input type="button" id="selectPermalink" value="Bookmark Topic" onClick="PLclick('bookmark',window.permalinkData);" />
   </td>
   <td align="right">
   <input type="button" id="closePermalink" value="Close Dialog Box"onClick="PLclick('close','');" />
   </td>
   </tr>
   <tr>
   <td colspan="3" align="center">
    <textarea id="plinkBox" readonly="readonly"></textarea>
   </td>
   </tr>
</table>


</div>  

<div id="idcontent"><div id="innerdiv">
<!--ZOOMRESTART-->
<p>Whenever a user saves a macro expression, the system automatically adds a security signature. This signature contains the user name of the macro's author and a hash of the expression. If the execution of the macro requires any permissions (e.g. to read data from a specific object collection), the system resolves the macro only if the user specified by the signature has the appropriate permissions.</p>
<p>&nbsp;</p>
<p>To improve security, the hash function used when creating macro signatures appends a <span style="font-style: italic;">salt</span> to the input (a sequence of additional characters). By default, the system uses the application's main database connection string as the salt (i.e. the exact <span class="f_IndentedListLevel2" style="font-weight: bold;">CMSConnectionString</span> value set in the web.config file). You can also assign a custom salt through the <span style="font-weight: bold;">CMSHashStringSalt</span> web.config key.</p>
<p>&nbsp;</p>
<p>If your application's salt changes, the security signatures of existing macro expressions become invalid. This may lead to problems with unresolved macros in certain scenarios, for example when:</p>
<p>&nbsp;</p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 9px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_IndentedList">The connection string of your application has changed, e.g. when moving to a different server or after setting a new database password.</span></p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 9px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_IndentedList">You are using <a href="http://devnet.kentico.com/docs/7_0/devguide/module_content_staging_overview.htm" target="_blank" class="weblink">Content staging</a> to transfer data containing macros to an instance of Kentico CMS with a different connection string.</span></p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 9px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_IndentedList">You have set a new custom salt via the </span><span class="f_IndentedList" style="font-weight: bold;">CMSHashStringSalt</span><span class="f_IndentedList"> web.config key.</span></p><p>&nbsp;</p>
<h2 class="p_Heading2"><span class="f_Heading2">Re-signing macros</span></h2>
<p>&nbsp;</p>
<p>This page allows you to fix invalid macro signatures by re-signing all macros using a new hash salt:</p>
<p>&nbsp;</p>
<p>1. Fill in the <span style="font-weight: bold;">Old salt</span> field.</p>
<p>&nbsp;</p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 9px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_IndentedList">If you leave the </span><span class="f_IndentedList" style="font-weight: bold;">Sign all macros</span><span class="f_IndentedList"> option </span><span class="f_IndentedList" style="font-style: italic;">disabled</span><span class="f_IndentedList">, the system attempts to re-sign macros based on the data in the original signatures. As a result, only macros that have a valid signature under the old salt are re-signed and the user names of the macro authors remain unchanged. You need to enter the old salt that was used to generate the security hash of the existing macro expressions in the system.</span></p><p class="p_IndentedList"><span class="f_IndentedList">&nbsp;</span></p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 27px;"><span style="font-size:10pt; font-family: 'Courier New';color:#000000;display:inline-block;width:13px;margin-left:-13px">o</span><span class="f_IndentedListLevel2">By default, the old salt is the value of the application's previous connection string in format:</span><br />
<span class="f_IndentedListLevel2" style="font-style: italic;">Persist Security Info=False;database=DBName;server=ServerName;user id=DBUser;password=pwd;Current Language=English;Connection Timeout=240;</span></p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 27px;"><span style="font-size:10pt; font-family: 'Courier New';color:#000000;display:inline-block;width:13px;margin-left:-13px">o</span><span class="f_IndentedListLevel2">If your application uses a custom hash salt, enter the original value of the </span><span class="f_IndentedListLevel2" style="font-weight: bold;">CMSHashStringSalt</span><span class="f_IndentedListLevel2"> web.config key.</span></p><p class="p_IndentedListLevel2"><span class="f_IndentedListLevel2">&nbsp;</span></p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 9px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_IndentedList">If you </span><span class="f_IndentedList" style="font-style: italic;">enable</span><span class="f_IndentedList"> </span><span class="f_IndentedList" style="font-weight: bold;">Sign all macros</span><span class="f_IndentedList">, the macro re-signing process skips the signature integrity check and creates new signatures for all macros. This includes macros that are unsigned or have invalid signatures. The new signatures use the name of the user who started the re-signing procedure. You do not need to enter the old salt value in this case.</span></p><p>&nbsp;</p>
<p>2. Type in the <span style="font-weight: bold;">New salt</span> that will be used to re-sign the macros.</p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 27px;"><span style="font-size:10pt; font-family: 'Courier New';color:#000000;display:inline-block;width:13px;margin-left:-13px">o</span><span class="f_IndentedListLevel2">By default, the field automatically loads the current application's hash salt value. To enter a different value, disable the </span><span class="f_IndentedListLevel2" style="font-weight: bold;">Use current salt</span><span class="f_IndentedListLevel2"> option.</span></p><p>&nbsp;</p>
<div style="text-align: justify; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 0px 0px 0px 0px;"><table style="border:solid 1px #000000; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; width:57px; padding:10px; border:none"><p style="text-align: justify;"><span style="color: #000000;">&nbsp;</span></p>
<p style="text-align: justify;"><img src="infobox_exclamation.png" width="51" height="54" alt="InfoBox_Exclamation" style="border:none" /></p>
</td>
<td style="vertical-align:top; width:511px; padding:10px; border:none"><p><span style="color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Important!</span></p>
<p>&nbsp;</p>
<p>In order for the system to correctly validate macro signatures, the new hash salt value must match the current salt of the application (the connection string or <span style="font-weight: bold;">CMSHashStringSalt</span> key value). </p>
<p>&nbsp;</p>
<p>Only set a different value than the current salt if you are planning to change the connection string or custom salt.</p>
<p>&nbsp;</p>
</td>
</tr>
</table>
</div>
<p>&nbsp;</p>
<p>3. Click <span style="font-weight: bold;">Update macro signatures</span>.</p>
<p>&nbsp;</p>
<p>The system replaces the security signature in all occurrences of macros based on the new salt.</p>
<p>&nbsp;</p>
<p>Additional resources:</p>
<p>&nbsp;</p>
<p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 9px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_IndentedList"><a href="http://devnet.kentico.com/docs/7_0/devguide/macro_expressions_overview.htm" target="_blank" class="weblink">Developer's Guide -&gt; Development -&gt; Macro expressions</a></span></p><p style="text-align: left; padding: 0px 0px 0px 13px; margin: 0px 0px 0px 9px;"><span style="font-size:10pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;display:inline-block;width:13px;margin-left:-13px">&#8226;</span><span class="f_IndentedList"><a href="http://devnet.kentico.com/docs/7_0/devguide/macro_security.htm" target="_blank" class="weblink">Developer's Guide -&gt; Development -&gt; Macro expressions -&gt; Security</a></span></p><p>&nbsp;</p>

<!--ZOOMSTOP--> 


<noscript>
<p class="help-url"><b>Help URL:&nbsp;</b><a href="http://devnet.kentico.com/docs/7_0/contexthelp/index.html?macros_tab.htm" target="_top" title="Right-click to copy the URL of this help topic">
http://devnet.kentico.com/docs/7_0/contexthelp/index.html?macros_tab.htm</a> 
</p>
</noscript>
<script type="text/javascript">
var richPL = (false && (navigator.platform.indexOf("iPad") === -1 && navigator.platform.indexOf("iPhone") === -1) && isFlash());
writePermalink(richPL,"Generate a link to this topic for copying or bookmark it in your browser","Generate Permalink or Bookmark Topic","Right-click to copy the URL of this help topic","Help URL:");
</script>


</div></div>   
</body>
</html>


